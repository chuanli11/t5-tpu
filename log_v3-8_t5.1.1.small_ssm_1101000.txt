WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
INFO:tensorflow:Loading NQ from cache.
2020-07-07 07:15:31.986507: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-07-07 07:15:31.992590: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 2300000000 Hz
2020-07-07 07:15:31.992921: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x6de1220 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-07 07:15:31.992952: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-07 07:15:33.056859: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.240.1.2:8470}
2020-07-07 07:15:33.056931: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34225}
2020-07-07 07:15:33.071182: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job worker -> {0 -> 10.240.1.2:8470}
2020-07-07 07:15:33.071245: I tensorflow/core/distributed_runtime/rpc/grpc_channel.cc:301] Initialize GrpcChannelCache for job localhost -> {0 -> localhost:34225}
2020-07-07 07:15:33.072028: I tensorflow/core/distributed_runtime/rpc/grpc_server_lib.cc:390] Started server with target: grpc://localhost:34225
2020-07-07 07:15:33.926688: W tensorflow/core/kernels/data/cache_dataset_ops.cc:794] The calling iterator did not fully read the dataset being cached. In order to avoid unexpected truncation of the dataset, the partially cached contents of the dataset will be discarded. This can happen if you have an input pipeline similar to `dataset.cache().take(k).repeat()`. You should use `dataset.take(k).cache().repeat()` instead.
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Reusing dataset trivia_qa (gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0)
INFO:absl:Constructing tf.data.Dataset for split None, from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Reusing dataset trivia_qa (gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0)
INFO:absl:Constructing tf.data.Dataset for split validation, from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
WARNING:tensorflow:legacy mode - ignoring custom sublayers
WARNING:tensorflow:legacy mode - ignoring custom sublayers
INFO:tensorflow:Using config: {'_model_dir': 'gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      key: 0
      value: "10.240.1.2:8470"
    }
  }
}
isolate_session_state: true
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': None, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({'worker': ['10.240.1.2:8470']}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': 'grpc://10.240.1.2:8470', '_evaluation_master': 'grpc://10.240.1.2:8470', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_tpu_config': TPUConfig(iterations_per_loop=100, num_shards=None, num_cores_per_replica=1, per_host_input_for_training=4, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None, eval_training_input_configuration=2, experimental_host_call_every_n_steps=1), '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fbc2c16ae10>}
INFO:tensorflow:_TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.2:8470) for TPU system metadata.
2020-07-07 07:15:40.300706: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:373] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Initializing TPU system (master: grpc://10.240.1.2:8470) to fetch topology for model parallelism. This might take a while.
INFO:tensorflow:Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 7533422438908897072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, -6065503160728324497)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 7853974898609235456)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, -4457928722324512756)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, -8626289396457069816)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, -2971832177554114716)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 350991301446816209)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, -4349122040420970381)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 940405642090098414)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 4933698774021788044)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 1962604806356682646)
WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:1666: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/training/training_util.py:236: Variable.initialized_value (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Use Variable.read_value. Variables in 2.X are initialized automatically both in eager and graph (inside tf.defun) contexts.
INFO:tensorflow:Calling model_fn.
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Reusing dataset trivia_qa (gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0)
INFO:absl:Constructing tf.data.Dataset for split train, from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:tensorflow:enable_2d_tiling: False
INFO:tensorflow:num_cores_per_replica: 1
INFO:tensorflow:computation_shape: [1, 1, 1]
INFO:tensorflow:num_replicas: 8
INFO:tensorflow:device_assignment.topology.device_coordinates: [[[0 0 0]
  [0 0 1]
  [1 0 0]
  [1 0 1]
  [0 1 0]
  [0 1 1]
  [1 1 0]
  [1 1 1]]]
INFO:tensorflow:device_assignment.core_assignment: [[[0 0 0]]

 [[0 0 1]]

 [[0 1 0]]

 [[0 1 1]]

 [[1 0 0]]

 [[1 0 1]]

 [[1 1 0]]

 [[1 1 1]]]
INFO:tensorflow:auto_logical_to_physical_tpu logical_shape=[8] physical_shape=[2, 2, 2]
INFO:tensorflow:auto_logical_to_physical_tpu logical_to_physical = [(0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (1, 1, 0), (1, 1, 1), (1, 0, 0), (1, 0, 1)]
WARNING:tensorflow:SimdMeshImpl ignoring devices ['', '', '', '', '', '', '', '']
INFO:tensorflow:SimdMeshImpl init: Shape[batch=8] LayoutRules{('d_ff', 'model'), ('batch', 'batch'), ('vocab', 'model'), ('ensemble', 'ensemble'), ('heads', 'model'), ('experts', 'batch')}
INFO:tensorflow:Device Assignment: <tensorflow.python.tpu.device_assignment.DeviceAssignment object at 0x7fbc24226a20>
INFO:tensorflow:serialize_num_microbatches: tokens_per_microbatch_per_replica=4096 batch_dim=Dimension(name='batch', size=256) sequence_length={'inputs': 128, 'targets': 32} batch_per_replica=32 num_microbatches=1
WARNING:tensorflow:Using default tf glorot_uniform_initializer for variable encoder/block_000/layer_000/SelfAttention/relative_attention_bias  The initialzer will guess the input and output dimensions  based on dimension order.
WARNING:tensorflow:Using default tf glorot_uniform_initializer for variable decoder/block_000/layer_000/SelfAttention/relative_attention_bias  The initialzer will guess the input and output dimensions  based on dimension order.
INFO:tensorflow:Create pnum_tensor
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/logits/kernel                                        size 16449536     slice_size 16449536     Shape[d_model=512, vocab=32128]                             
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable shared/embedding                                             size 16449536     slice_size 16449536     Shape[vocab=32128, d_model=512]                             
INFO:tensorflow:Variable stacked/encoder/block_000/layer_000/SelfAttention/relative_attention_bias size 384          slice_size 384          Shape[stacked=2, heads=6, buckets=32]                       
INFO:tensorflow:    encoder/block_000/layer_000/SelfAttention/relative_attention_bias
INFO:tensorflow:    decoder/block_000/layer_000/SelfAttention/relative_attention_bias
INFO:tensorflow:Variable stacked/encoder/block_000/layer_000/layer_norm/scale         size 21504        slice_size 21504        Shape[stacked=42, d_model=512]                              
INFO:tensorflow:    encoder/block_000/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_000/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_001/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_001/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_002/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_002/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_003/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_003/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_004/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_004/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_005/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_005/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_006/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_006/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_007/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_007/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/final_layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/final_layer_norm/scale
INFO:tensorflow:Trainable Variables            count: 148     Total size: 76961152         Total slice_size: 76961152       
INFO:tensorflow:All Variables                  count: 154     Total size: 77208064         Total slice_size: 77208064       
INFO:tensorflow:Counters:
allreduce: 6.22e+08
 allreduce/[0]: 6.22e+08
  allreduce/[0]/einsum_op: 6.16e+08
  allreduce/[0]/reduce_op: 6.68e+06
einsum: 5.25e+12
einsum_unique: 5.25e+12
output: 4.18e+10
 output/AddOperation: 6.1e+09
 output/BinaryOpWithBroadcasting: 6.05e+07
 output/BroadcastOperation: 1.18e+09
 output/Constant: 8
 output/EinsumOperation: 2.04e+10
 output/ImportOperation: 9.88e+05
 output/MinMaxOperation: 1.18e+06
 output/OneHotOperation: 1.61e+09
 output/RandomOperation: 1.35e+07
 output/RangeOperation: 1.28e+03
 output/ReduceOperation: 2.77e+08
 output/ReshapeOperation: 2.18e+09
 output/ScalarAddOperation: 9.54e+08
 output/ScalarMultiplyOperation: 2.47e+09
 output/ShiftOperation: 8.19e+03
 output/SlicewiseOperation: 5.39e+09
 output/StackOperation: 2.15e+06
 output/StackedVariable: 2.15e+06
 output/StopGradient: 5.27e+08
 output/UnstackOperation: 2.15e+06
 output/Variable: 6.16e+08
output_unique: 3.5e+10
 output_unique/AddOperation: 5.98e+09
 output_unique/BinaryOpWithBroadcasting: 5.86e+07
 output_unique/BroadcastOperation: 1.18e+09
 output_unique/Constant: 1
 output_unique/EinsumOperation: 1.76e+10
 output_unique/ImportOperation: 1.23e+05
 output_unique/MinMaxOperation: 1.48e+05
 output_unique/OneHotOperation: 1.58e+09
 output_unique/RandomOperation: 1.35e+07
 output_unique/RangeOperation: 160
 output_unique/ReduceOperation: 2.69e+08
 output_unique/ReshapeOperation: 2.18e+09
 output_unique/ScalarAddOperation: 4.14e+08
 output_unique/ScalarMultiplyOperation: 2.46e+09
 output_unique/ShiftOperation: 8.19e+03
 output_unique/SlicewiseOperation: 2.69e+09
 output_unique/StackOperation: 2.69e+05
 output_unique/StackedVariable: 2.69e+05
 output_unique/StopGradient: 5.27e+08
 output_unique/UnstackOperation: 2.69e+05
 output_unique/Variable: 7.69e+07
variables: 7.72e+07
 variables/trainable: 7.7e+07
 variables/untrainable: 2.47e+05
INFO:tensorflow:Initializing variables from gs://t5-tutorial-storage/pretrained/t5.1.1.small_ssm/model.ckpt-1100000:
INFO:tensorflow:Variables in gs://t5-tutorial-storage/pretrained/t5.1.1.small_ssm/model.ckpt-1100000 but not in graph:
INFO:tensorflow:
INFO:tensorflow:Variables in graph but not in gs://t5-tutorial-storage/pretrained/t5.1.1.small_ssm/model.ckpt-1100000:
INFO:tensorflow:
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:TPU job name worker
INFO:tensorflow:Starting the session.
INFO:tensorflow:Graph was finalized.
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow_estimator/python/estimator/tpu/tpu_estimator.py:767: Variable.load (from tensorflow.python.ops.variables) is deprecated and will be removed in a future version.
Instructions for updating:
Prefer Variable.assign which has equivalent behavior in 2.X.
INFO:tensorflow:Initialized dataset iterators in 1 seconds
INFO:tensorflow:Installing graceful shutdown hook.
2020-07-07 07:16:38.054789: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:373] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
INFO:tensorflow:Before copy master to slices.
INFO:tensorflow:Done with copy master to slices.
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1100000...
INFO:tensorflow:Before Save.
INFO:tensorflow:About to write a checkpoint
INFO:tensorflow:Saving checkpoints for 1100000 into gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1100000...
INFO:tensorflow:Done writing checkpoint.
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:Outfeed finished for iteration (0, 0)
INFO:tensorflow:loss = 0.10546875, step = 1100100
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.100097656, step = 1100200 (12.026 sec)
INFO:tensorflow:global_step/sec: 8.31482
INFO:tensorflow:examples/sec: 2128.59
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.096191406, step = 1100300 (7.936 sec)
INFO:tensorflow:global_step/sec: 12.6023
INFO:tensorflow:examples/sec: 3226.19
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.092285156, step = 1100400 (9.078 sec)
INFO:tensorflow:global_step/sec: 11.0142
INFO:tensorflow:examples/sec: 2819.64
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.087402344, step = 1100500 (7.674 sec)
INFO:tensorflow:global_step/sec: 13.0327
INFO:tensorflow:examples/sec: 3336.36
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.08984375, step = 1100600 (9.503 sec)
INFO:tensorflow:global_step/sec: 10.5227
INFO:tensorflow:examples/sec: 2693.82
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.084472656, step = 1100700 (8.285 sec)
INFO:tensorflow:global_step/sec: 12.0703
INFO:tensorflow:examples/sec: 3090
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:Outfeed finished for iteration (7, 10)
INFO:tensorflow:loss = 0.08105469, step = 1100800 (8.330 sec)
INFO:tensorflow:global_step/sec: 12.0048
INFO:tensorflow:examples/sec: 3073.24
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.078125, step = 1100900 (8.216 sec)
INFO:tensorflow:global_step/sec: 12.1711
INFO:tensorflow:examples/sec: 3115.81
INFO:tensorflow:Enqueue next (100) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (100) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.080078125, step = 1101000 (8.183 sec)
INFO:tensorflow:global_step/sec: 12.2213
INFO:tensorflow:examples/sec: 3128.64
INFO:tensorflow:Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
INFO:tensorflow:Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
INFO:tensorflow:Calling checkpoint listeners before saving checkpoint 1101000...
INFO:tensorflow:Before Save.
INFO:tensorflow:About to write a checkpoint
INFO:tensorflow:Saving checkpoints for 1101000 into gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm/model.ckpt.
INFO:tensorflow:Calling checkpoint listeners after saving checkpoint 1101000...
INFO:tensorflow:Done writing checkpoint.
INFO:tensorflow:Done with the session.
INFO:tensorflow:Loss for final step: 0.080078125.
INFO:tensorflow:training_loop marked as finished
WARNING:tensorflow:legacy mode - ignoring custom sublayers
WARNING:tensorflow:legacy mode - ignoring custom sublayers
INFO:tensorflow:Using config: {'_model_dir': 'gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': None, '_save_checkpoints_secs': None, '_session_config': allow_soft_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      key: 0
      value: "10.240.1.2:8470"
    }
  }
}
isolate_session_state: true
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': None, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_experimental_max_worker_delay_secs': None, '_session_creation_timeout_secs': 7200, '_service': None, '_cluster_spec': ClusterSpec({'worker': ['10.240.1.2:8470']}), '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': 'grpc://10.240.1.2:8470', '_evaluation_master': 'grpc://10.240.1.2:8470', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1, '_tpu_config': TPUConfig(iterations_per_loop=100, num_shards=None, num_cores_per_replica=1, per_host_input_for_training=4, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None, eval_training_input_configuration=2, experimental_host_call_every_n_steps=1), '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fbc2c16ae10>}
INFO:tensorflow:_TPUContext: eval_on_tpu True
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Reusing dataset trivia_qa (gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0)
INFO:absl:Constructing tf.data.Dataset for split validation, from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:tensorflow:Checkpoint path gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm/model.ckpt-1101000
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.2:8470) for TPU system metadata.
2020-07-07 07:19:42.241858: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:373] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Initializing TPU system (master: grpc://10.240.1.2:8470) to fetch topology for model parallelism. This might take a while.
INFO:tensorflow:Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 7533422438908897072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, -6065503160728324497)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 7853974898609235456)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, -4457928722324512756)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, -8626289396457069816)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, -2971832177554114716)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 350991301446816209)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, -4349122040420970381)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 940405642090098414)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 4933698774021788044)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 1962604806356682646)
INFO:tensorflow:Calling model_fn.
INFO:absl:Load dataset info from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:absl:Reusing dataset trivia_qa (gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0)
INFO:absl:Constructing tf.data.Dataset for split validation, from gs://t5-tutorial-storage/data/trivia_qa/unfiltered.nocontext/1.1.0
INFO:tensorflow:enable_2d_tiling: False
INFO:tensorflow:num_cores_per_replica: 1
INFO:tensorflow:computation_shape: [1, 1, 1]
INFO:tensorflow:num_replicas: 8
INFO:tensorflow:device_assignment.topology.device_coordinates: [[[0 0 0]
  [0 0 1]
  [1 0 0]
  [1 0 1]
  [0 1 0]
  [0 1 1]
  [1 1 0]
  [1 1 1]]]
INFO:tensorflow:device_assignment.core_assignment: [[[0 0 0]]

 [[0 0 1]]

 [[0 1 0]]

 [[0 1 1]]

 [[1 0 0]]

 [[1 0 1]]

 [[1 1 0]]

 [[1 1 1]]]
INFO:tensorflow:auto_logical_to_physical_tpu logical_shape=[8] physical_shape=[2, 2, 2]
INFO:tensorflow:auto_logical_to_physical_tpu logical_to_physical = [(0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (1, 1, 0), (1, 1, 1), (1, 0, 0), (1, 0, 1)]
WARNING:tensorflow:SimdMeshImpl ignoring devices ['', '', '', '', '', '', '', '']
INFO:tensorflow:SimdMeshImpl init: Shape[batch=8] LayoutRules{('d_ff', 'model'), ('batch', 'batch'), ('vocab', 'model'), ('ensemble', 'ensemble'), ('heads', 'model'), ('experts', 'batch')}
INFO:tensorflow:Device Assignment: <tensorflow.python.tpu.device_assignment.DeviceAssignment object at 0x7fbbb805b748>
WARNING:tensorflow:Using default tf glorot_uniform_initializer for variable encoder/block_000/layer_000/SelfAttention/relative_attention_bias  The initialzer will guess the input and output dimensions  based on dimension order.
WARNING:tensorflow:Using default tf glorot_uniform_initializer for variable decoder/block_000/layer_000/SelfAttention/relative_attention_bias  The initialzer will guess the input and output dimensions  based on dimension order.
WARNING:tensorflow:Using default tf glorot_uniform_initializer for variable decoder/block_000/layer_000/SelfAttention/relative_attention_bias  The initialzer will guess the input and output dimensions  based on dimension order.
INFO:tensorflow:Create pnum_tensor
INFO:tensorflow:Casting <dtype: 'int32'> to float32 for allreduce
INFO:tensorflow:Casting <dtype: 'int32'> to float32 for allreduce
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_000/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_001/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_002/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_003/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_004/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_005/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_006/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/k                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/o                size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/q                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_001/EncDecAttention/v                size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable decoder/block_007/layer_002/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable decoder/logits/kernel                                        size 16449536     slice_size 16449536     Shape[d_model=512, vocab=32128]                             
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_000/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_001/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_002/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_003/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_004/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_005/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_006/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/k                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/o                  size 196608       slice_size 196608       Shape[heads=384, d_model=512]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/q                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_000/SelfAttention/v                  size 196608       slice_size 196608       Shape[d_model=512, heads=384]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wi_0/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wi_1/kernel       size 524288       slice_size 524288       Shape[d_model=512, d_ff=1024]                               
INFO:tensorflow:Variable encoder/block_007/layer_001/DenseReluDense/wo/kernel         size 524288       slice_size 524288       Shape[d_ff=1024, d_model=512]                               
INFO:tensorflow:Variable shared/embedding                                             size 16449536     slice_size 16449536     Shape[vocab=32128, d_model=512]                             
INFO:tensorflow:Variable stacked/encoder/block_000/layer_000/SelfAttention/relative_attention_bias size 384          slice_size 384          Shape[stacked=2, heads=6, buckets=32]                       
INFO:tensorflow:    encoder/block_000/layer_000/SelfAttention/relative_attention_bias
INFO:tensorflow:    decoder/block_000/layer_000/SelfAttention/relative_attention_bias
INFO:tensorflow:Variable stacked/encoder/block_000/layer_000/layer_norm/scale         size 21504        slice_size 21504        Shape[stacked=42, d_model=512]                              
INFO:tensorflow:    encoder/block_000/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_000/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_001/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_001/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_002/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_002/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_003/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_003/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_004/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_004/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_005/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_005/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_006/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_006/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/block_007/layer_000/layer_norm/scale
INFO:tensorflow:    encoder/block_007/layer_001/layer_norm/scale
INFO:tensorflow:    encoder/final_layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_000/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_001/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_002/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_003/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_004/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_005/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_006/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_000/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_001/layer_norm/scale
INFO:tensorflow:    decoder/block_007/layer_002/layer_norm/scale
INFO:tensorflow:    decoder/final_layer_norm/scale
INFO:tensorflow:Trainable Variables            count: 148     Total size: 76961152         Total slice_size: 76961152       
INFO:tensorflow:All Variables                  count: 148     Total size: 76961152         Total slice_size: 76961152       
INFO:tensorflow:Counters:
allconcat: 2.1e+06
 allconcat/0: 2.1e+06
  allconcat/0/reshape_op: 2.1e+06
allreduce: 8
 allreduce/[0]: 8
  allreduce/[0]/reduce_op: 8
einsum: 1.26e+13
einsum_unique: 1.26e+13
output: 8.75e+10
 output/AddOperation: 1.29e+10
 output/BinaryOpWithBroadcasting: 1.42e+08
 output/Constant: 8.05e+08
 output/EinsumOperation: 3.52e+10
 output/ImportOperation: 1.31e+06
 output/MinMaxOperation: 3.28e+06
 output/OneHotOperation: 8.49e+09
 output/RangeOperation: 2.05e+03
 output/ReduceOperation: 4.33e+07
 output/ReshapeOperation: 7.18e+09
 output/ScalarAddOperation: 2.16e+09
 output/ScalarMultiplyOperation: 6.59e+09
 output/ShiftOperation: 1.31e+05
 output/SlicewiseOperation: 1.02e+10
 output/StackedVariable: 1.75e+05
 output/StopGradient: 2.42e+09
 output/UnstackOperation: 1.75e+05
 output/Variable: 6.16e+08
 output/WhileLoopOperation: 8.05e+08
output_unique: 8.68e+10
 output_unique/AddOperation: 1.29e+10
 output_unique/BinaryOpWithBroadcasting: 1.38e+08
 output_unique/Constant: 8.05e+08
 output_unique/EinsumOperation: 3.52e+10
 output_unique/ImportOperation: 1.64e+05
 output_unique/MinMaxOperation: 5.24e+05
 output_unique/OneHotOperation: 8.43e+09
 output_unique/RangeOperation: 256
 output_unique/ReduceOperation: 4.33e+07
 output_unique/ReshapeOperation: 7.18e+09
 output_unique/ScalarAddOperation: 2.15e+09
 output_unique/ScalarMultiplyOperation: 6.58e+09
 output_unique/ShiftOperation: 1.31e+05
 output_unique/SlicewiseOperation: 1.01e+10
 output_unique/StackedVariable: 2.19e+04
 output_unique/StopGradient: 2.42e+09
 output_unique/UnstackOperation: 2.19e+04
 output_unique/Variable: 7.69e+07
 output_unique/WhileLoopOperation: 8.05e+08
variables: 7.7e+07
 variables/trainable: 7.7e+07
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:TPU job name worker
INFO:tensorflow:Graph was finalized.
INFO:tensorflow:Restoring parameters from gs://t5-tutorial-storage/models-v3-8/t5.1.1.small_ssm/model.ckpt-1101000
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
INFO:tensorflow:Before copy master to slices.
INFO:tensorflow:Done with copy master to slices.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Outfeed finished for iteration (0, 0)
INFO:tensorflow:decoded 0: trivia question: what do the 3 dots mean in math?
INFO:tensorflow:            -> a number of numbers
INFO:tensorflow:decoded 1: trivia question: who is playing the halftime show at super bowl 2016?
INFO:tensorflow:            -> the broncos
INFO:tensorflow:decoded 2: trivia question: who won the 2017 sports personality of the year?
INFO:tensorflow:            -> eddie mcdonald
INFO:tensorflow:decoded 4: trivia question: who has made the most premier league appearances?
INFO:tensorflow:            -> eddie mccoy
INFO:tensorflow:decoded 8: trivia question: when was the first hunger games book published?
INFO:tensorflow:            -> june 22, 1931
INFO:tensorflow:decoded 16: trivia question: who plays emma in air bud world pup?
INFO:tensorflow:            -> emma elisabeth scott
INFO:tensorflow:decoded 32: trivia question: who scored the most points in their nba career?
INFO:tensorflow:            -> ray allen
INFO:tensorflow:decoded 64: trivia question: who gave the famous objective co relative theory?
INFO:tensorflow:            -> edwin l. scott
INFO:tensorflow:decoded 128: trivia question: who acts as the chairman of the election commission?
INFO:tensorflow:            -> the president of the united states
INFO:tensorflow:decoded 256: trivia question: who is the longest serving member of the house in history?
INFO:tensorflow:            -> john f. kennedy
INFO:tensorflow:decoded 512: trivia question: how tall is the actor who plays hagrid in harry potter?
INFO:tensorflow:            -> a tiger
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:decoded 1024: trivia question: what is it called when you believe in greek gods?
INFO:tensorflow:            -> christianity
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:decoded 2048: trivia question: when did marathon change its name to snickers?
INFO:tensorflow:            -> november 1, 2017
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:decoded 4096: trivia question: which famous huntsman who was known for wearing a grey coat was buried in caldbeck cemetery
INFO:tensorflow:            -> charles edwards
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:decoded 8192: trivia question: who was the american president when the berlin wall was constructed?
INFO:tensorflow:            -> franklin d. roosevelt
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Enqueue next (1) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (1) batch(es) of data from outfeed.
INFO:tensorflow:Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
INFO:tensorflow:Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
INFO:tensorflow:prediction_loop marked as finished
INFO:tensorflow:prediction_loop marked as finished
INFO:tensorflow:eval/nq_context_free/accuracy at step 1101000: 1.326
INFO:tensorflow:eval/triviaqa_context_free/accuracy at step 1101000: 2.449
Setting up GCS access...
Running on TPU: grpc://10.240.1.2:8470
A few raw validation examples...
{'question': b'what do the 3 dots mean in math?', 'answer': b'the therefore sign (\xe2\x88\xb4) is generally used before a logical consequence, such as the conclusion of a syllogism'}
{'question': b'who is playing the halftime show at super bowl 2016?', 'answer': b'Coldplay with special guest performers Beyonc\xc3\xa9 and Bruno Mars'}
{'question': b'who won the 2017 sports personality of the year?', 'answer': b'Mo Farah'}
{'question': b'where was the world economic forum held this year?', 'answer': b'Davos, a mountain resort in Graub\xc3\xbcnden, in the eastern Alps region of Switzerland'}
{'question': b'who has made the most premier league appearances?', 'answer': b'Gareth Barry'}
A few preprocessed validation examples...
{'inputs_plaintext': b'trivia question: who played stumpy in the movie rio bravo?', 'inputs': array([22377,   822,    10,   113,  1944, 27879,    63,    16,     8,
        1974,     3,    52,    23,    32,  3858,  1621,    58,     1]), 'targets_plaintext': b'walter brennan', 'targets': array([   3,  210, 8818, 6397,   35,   29,  152,    1])}
{'inputs_plaintext': b'trivia question: the first line of http request message is called ____?', 'inputs': array([22377,   822,    10,     8,   166,   689,    13,  2649,  1690,
        1569,    19,   718,     3,   834,   834,   834,   834,    58,
           1]), 'targets_plaintext': b'status line', 'targets': array([2637,  689,    1])}
{'inputs_plaintext': b'trivia question: what was the first form of manga in japan?', 'inputs': array([22377,   822,    10,   125,    47,     8,   166,   607,    13,
       20796,    16,  2662,  2837,    58,     1]), 'targets_plaintext': b'scrolls dating back to the 12th century', 'targets': array([11930,     7,  4134,   223,    12,     8,   586,   189,  2646,
           1])}
{'inputs_plaintext': b'trivia question: krypton-85 decays by emission of a beta particle. the product of this decay is?', 'inputs': array([22377,   822,    10,     3,   157,   651, 11632,    18,  4433,
       18907,     7,    57, 24578,    13,     3,     9, 12637, 24317,
           5,     8,   556,    13,    48, 18907,    19,    58,     1]), 'targets_plaintext': b'rubidium-85', 'targets': array([ 9641,    23, 12925,    18,  4433,     1])}
{'inputs_plaintext': b'trivia question: explain the function of the peripheral nervous system?', 'inputs': array([22377,   822,    10,  3209,     8,  1681,    13,     8, 22586,
       10045,   358,    58,     1]), 'targets_plaintext': b'to connect the cns to the limbs and organs, essentially serving as a relay between the brain and spinal cord and the rest of the body', 'targets': array([   12,  1979,     8,     3,    75,    29,     7,    12,     8,
           3,  9577,     7,    11,  3640,     7,     6,     3,  8317,
        3122,    38,     3,     9, 16010,   344,     8,  2241,    11,
       18012,  7496,    11,     8,     1])}
A few raw validation examples...
{'answer': {'aliases': array([b'Torquemada (disambiguation)', b'Torquemada'], dtype=object), 'matched_wiki_entity_name': b'', 'normalized_aliases': array([b'torquemada', b'torquemada disambiguation'], dtype=object), 'normalized_matched_wiki_entity_name': b'', 'normalized_value': b'torquemada', 'type': b'WikipediaEntity', 'value': b'Torquemada'}, 'entity_pages': {'doc_source': array([], dtype=object), 'filename': array([], dtype=object), 'title': array([], dtype=object), 'wiki_context': array([], dtype=object)}, 'question': b'In 1483, who was appointed the first grand inquisitor of the Spanish Inquisition?', 'question_id': b'qw_16011', 'question_source': b'http://www.quizwise.com/', 'search_results': {'description': array([], dtype=object), 'filename': array([], dtype=object), 'rank': array([], dtype=int32), 'search_context': array([], dtype=object), 'title': array([], dtype=object), 'url': array([], dtype=object)}}
{'answer': {'aliases': array([b'Austerlitz (disambiguation)', b'Austerlitz', b'AUSTERLITZ'],
      dtype=object), 'matched_wiki_entity_name': b'', 'normalized_aliases': array([b'austerlitz', b'austerlitz disambiguation'], dtype=object), 'normalized_matched_wiki_entity_name': b'', 'normalized_value': b'austerlitz', 'type': b'WikipediaEntity', 'value': b'AUSTERLITZ'}, 'entity_pages': {'doc_source': array([], dtype=object), 'filename': array([], dtype=object), 'title': array([], dtype=object), 'wiki_context': array([], dtype=object)}, 'question': b'Which celebrated battle was fought near Brno on 2nd December 1805?', 'question_id': b'dpql_4053', 'question_source': b'https://derbyshirepubquizleague.wordpress.com/', 'search_results': {'description': array([], dtype=object), 'filename': array([], dtype=object), 'rank': array([], dtype=int32), 'search_context': array([], dtype=object), 'title': array([], dtype=object), 'url': array([], dtype=object)}}
A few preprocessed validation examples...
{'inputs_plaintext': b'trivia question: what is the name of the salvador dali painting that shows clocks oozing over a landscape?', 'inputs': array([22377,   822,    10,   125,    19,     8,   564,    13,     8,
       18770,    26,   127,     3,    26,  4288,  3924,    24,  1267,
        6702,     7,     3,    32,    32,  8128,   147,     3,     9,
        3283,    58,     1]), 'targets_plaintext': b'the persistence of memory', 'targets': array([    8, 29486,    13,  2594,     1])}
{'inputs_plaintext': b'trivia question: what is the astronomical link between hell, birmingham and archimedes?', 'inputs': array([22377,   822,    10,   125,    19,     8,     3, 12466,  1950,
        1309,   344,  7927,     6,     3,  8781,    51, 14799,    11,
       11508,  5445,  1395,    58,     1]), 'targets_plaintext': b'all are craters on the moon', 'targets': array([  66,   33,    3, 2935, 4849,   30,    8, 8114,    1])}
{'inputs_plaintext': b'trivia question: what ancient civilization was centred in the north of ancient canaan, with its heartland along the coastal regions of modern day lebanon, syria and israel?', 'inputs': array([22377,   822,    10,   125,  4913, 20927,    47,  2050,    26,
          16,     8,  3457,    13,  4913,    54,     9,   152,     6,
          28,   165,   842,    40,   232,   590,     8, 13064,  6266,
          13,   941,   239,    90,  3478,   106,     6,     3,     7,
          63,    52,    23,     9,    11,     3, 30178,    58,     1]), 'targets_plaintext': b'phoenicia', 'targets': array([   3, 9553,   35, 1294,    9,    1])}
